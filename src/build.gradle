// https://github.com/domaframework/simple-boilerplate/blob/master/build.gradle
plugins {
    id 'java'
    id 'eclipse'
    id 'application'
    id 'com.github.spotbugs' version '4.7.1'
}
java {
    sourceCompatibility = JavaVersion.VERSION_1_8
    targetCompatibility = JavaVersion.VERSION_1_8
    mainClassName = 'com.example.nedo.app.Main'
}
distTar {
    archiveName = "phone-bill.tar"
}
distZip {
    archiveName = "phone-bill.zip"
}
jar {
    archiveName = "phone-bill.jar"
}
compileJava {
    options.encoding = 'UTF-8'
}
compileTestJava {
    options.encoding = 'UTF-8'
}
test {
    useJUnitPlatform() {
        excludeTags 'oracle'
    }
    testLogging {
        showStandardStreams true
        events 'started', 'skipped', 'passed', 'failed'
        exceptionFormat 'full'
    }
    if (project.hasProperty("phone-bill.url")) {
        systemProperty "phone-bill.url", project.getProperty("phone-bill.url")
    }
}
repositories {
  mavenCentral()
}
dependencies {
  // https://mvnrepository.com/artifact/org.postgresql/postgresql
  implementation group: 'org.postgresql', name: 'postgresql', version: '42.2.16'
  // https://mvnrepository.com/artifact/com.oracle.ojdbc/ojdbc8
  runtimeOnly group: 'com.oracle.database.jdbc', name: 'ojdbc8', version: '21.1.0.0'
  // https://mvnrepository.com/artifact/com.oracle.ojdbc/orai18n
  runtimeOnly group: 'com.oracle.database.nls', name: 'orai18n', version: '21.1.0.0'
  implementation group: 'com.oracle.database.jdbc', name: 'ucp', version: '21.1.0.0'
  testImplementation("org.junit.jupiter:junit-jupiter-api:5.7.2")
  testRuntimeOnly("org.junit.jupiter:junit-jupiter-engine:5.7.2")
  testRuntimeOnly("org.junit.platform:junit-platform-launcher:1.0.0") // for IDE
  implementation "commons-cli:commons-cli:1.4"
  implementation "ch.qos.logback:logback-classic:1.2.3"
  implementation "org.apache.commons:commons-math3:3.6.1"
  compileOnly"com.github.spotbugs:spotbugs-annotations:4.2.3"
  testCompileOnly"com.github.spotbugs:spotbugs-annotations:4.2.3"
}
startScripts {
    applicationName = 'run'
}
spotbugsMain {
    ignoreFailures = true
    reports {
        html {
            enabled = !project.hasProperty("ci")
            destination = file("$buildDir/reports/spotbugs/main/spotbugs.html")
            stylesheet = 'fancy-hist.xsl'
        }
        xml {
            enabled = project.hasProperty("ci")
            destination = file("$buildDir/reports/spotbugs/main/spotbugs.xml")
        }
    }
}
